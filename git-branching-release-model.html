<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <!-- Set the viewport width to device width for mobile -->
    <meta name="viewport" content="width=device-width" />

    <title>一般项目 git 分支及发布模型</title>

    <link rel="stylesheet" href="./theme/css/normalize.css" />
    <link rel="stylesheet" href="./theme/css/foundation.min.css" />
    <link rel="stylesheet" href="./theme/css/style.css" />
    <link rel="stylesheet" href="./theme/css/pygments.css" />	
    <script src="./theme/js/custom.modernizr.js"></script>
</head>

<body>

<!-- Nav Bar -->
<nav>
<div class="top-bar">
<div class="row">
    <div class="large-9 large-centered columns">
	    <h1><a href=".">Edge Define: To Extend</a></h1>
    </div>
</div>
</div>

<!-- Show menu items and pages -->
<div class="row">
<div class="large-9 columns">
    <ul class="button-group navigation">

    </ul>
</div>
</div>
</nav>
<!-- End Nav -->


<!-- Main Page Content and Sidebar -->
<div class="row">

    <!-- Main Blog Content -->
    <div class="large-9 columns">
<article>
    <header>
        <h3 class="article-title"><a href="./git-branching-release-model.html" rel="bookmark"
        title="Permalink to 一般项目 git 分支及发布模型">一般项目 git 分支及发布模型</a></h3>
    </header>

<h6 class="subheader" title="2018-04-03T00:00:00+08:00">二 03 四月 2018
</h6>


    <h1>Git Project branching &amp; releasing model</h1>
<p>In short, use <code>tag</code> to track every releases and use <code>branch</code> to keep developing parallelized.</p>
<h2>Two main branches</h2>
<p>During the project development lifecycle, there will be two branches that are almost always there  and be used often. Also, they carry  all the release tags.</p>
<p><img alt="master_release_branches" src="./images/master_release.png" /></p>
<h3><code>master( or develop)</code> branch</h3>
<p>We consider <code>origin/master</code> to be the main branch where the source code of <code>HEAD</code> always reflects a state with the latest delivered development changes for the next release. Some would call this the “integration branch”. This is where any automatic nightly builds are built from.</p>
<p><strong>NOTE:</strong> It's better not to commit directly onto your local <code>master</code> branch, try to use feature branch instead. Keep a clean local <code>master</code> will give you strong confident to get changes from remote by <code>rebase</code> or even just <code>pull</code> <code>origin/master</code>, also save your time in case your changes conflict with others. But if you're a git expert and you know exactly where you're and what you're doing, that's another story :-)</p>
<h3><code>release</code> branch</h3>
<p>We consider <code>origin/release</code> to be the main branch where the source code of <code>HEAD</code> always reflects a <code>deploy-ready</code> state, including <code>release-candidate</code>.</p>
<p>When the source code in the <code>master</code> branch reaches a stable point and is ready to be released, all of the changes should be merged  into <code>release</code>  and then tagged with a release number.</p>
<p>Normally, it's shoud be  one release candidate with a  <code>rc</code> tag and deploy onto the  <code>stage</code> environment. During the test or verify stage, all release related commits, including bug-fixes, should be landed on the <code>release</code> branch <strong>only</strong>.</p>
<p>Therefore, when we decide it is production ready, we can bump version to a normal release, add tag and merge back into <code>master</code>.</p>
<p><strong>NOTE:</strong> We use <code>release</code> branch to do the release procedure, including tests or verifications which may take days long, so the development that did not related or targeted to this release will keep moving forward on <code>master</code> branch. That's the point of using branches to keep developing parallelized.</p>
<h2>Other development branches</h2>
<p>It's always okay and recommended to create personal or feature branches, just remember to delete them when they've got merged or retired.</p>
<p>And when bug or something bad happend on production environment, we need to do a hot-fix, this is the time we should use a <code>hotfix-&lt;target_release_tag&gt;</code> branch.</p>
<h3>personal or feature branch</h3>
<p>Normally branch off from:
     <code>master</code>
Must merge back into:
    <code>master</code>
Common steps:</p>
<div class="highlight"><pre><span class="c"># keep up-to-date with remote master</span>
git fetch origin <span class="o">&amp;&amp;</span> git rebase --onto<span class="o">=</span>master origin/master
<span class="c"># create feature branch,</span>
git checkout -b myfeature master
<span class="c"># hack, hack, hack</span>
...
<span class="c"># push to remote and create a pull request or merge request or a code review</span>
git push origin myfeature
</pre></div>


<h3>hotfix branch</h3>
<p>Must branch off from:
    <code>&lt;target_release_tag&gt;</code>
Must merge back into:
    <code>release</code> and <code>master</code>
Branch naming convention:
    <code>hotfix-&lt;target_release_tag&gt;</code>
Common steps:</p>
<div class="highlight"><pre><span class="c"># keep up-to-date with remote master</span>
git fetch origin
<span class="c"># create hotfix branch,</span>
git checkout -b hotfix-&lt;buggy_release_tag&gt; &lt;buggy_release_tag&gt;
<span class="c"># hot fix</span>
...
<span class="c"># git tag and merge back to release and master after a quick verification on the fixes</span>
git tag -a -m <span class="s2">&quot;[hotfix]: xxxx&quot;</span> &lt;buggy_release_tag&gt;-hotfix
git push origin hotfix-&lt;buggy_release_tag&gt;
<span class="c"># push hotfix git tag</span>
git push origin &lt;buggy_release_tag&gt;-hotfix
</pre></div>


<p><img alt="hotfix_branch" src="./images/master_release_hotfix.png" /></p>
<h2>Release procedure</h2>
<ul>
<li>make sure all targetd feature commits have landed into the <code>master</code> branch</li>
</ul>
<div class="highlight"><pre>git fetch origin <span class="o">&amp;&amp;</span> git rebase --goto<span class="o">=</span>master origin/master
</pre></div>


<ul>
<li>merge them into the <code>release</code> branch</li>
</ul>
<div class="highlight"><pre>git checkout release
git rebase master
<span class="c"># or</span>
git rebase --goto<span class="o">=</span>release master
</pre></div>


<ul>
<li>tag with release candidate tag(optional)</li>
</ul>
<div class="highlight"><pre>git tag -a -m <span class="s2">&quot;[rc]: xxxx&quot;</span> &lt;release_tag&gt;-rc
</pre></div>


<ul>
<li>deploy to test/stage environment</li>
<li>merge release related commits if any</li>
<li>when it's ready to become a normal release, add release tag</li>
</ul>
<div class="highlight"><pre>git tag -a -m <span class="s2">&quot;[release]: xxxx&quot;</span> &lt;release_tag&gt;
</pre></div>


<ul>
<li>merge back into <code>master</code> along with tag</li>
</ul>
<div class="highlight"><pre><span class="c"># push release to remote, merge it back to master via PR or merge request or code review tool</span>
git push origin release
git push origin &lt;release_tag&gt;
</pre></div>


<ul>
<li>deploy production environment with release tag</li>
</ul>
<h2>Refs:</h2>
<ul>
<li>http://nvie.com/posts/a-successful-git-branching-model/</li>
<li>graph generated by: https://github.com/nicoespeon/gitgraph.js</li>
</ul>
<p class="subheader">Category: <a href="./category/git.html">git</a>

    Tagged: 
    <a href="./tag/git.html">git </a>
    <a href="./tag/branching.html">branching </a>
    <a href="./tag/release.html">release </a>
</p>




</article>
    </div>
    <!-- End Main Content -->

    <!-- Sidebar -->
    <aside class="large-3 columns">
        <h5 class="sidebar-title">Site</h5>
        <ul class="side-nav">
            <li><a href="./archives.html">Archives</a>
            <li><a href="./tags.html">Tags</a>
        </ul>

		
        <h5 class="sidebar-title">Categories</h5>
        <ul class="side-nav">
            <li><a href="./category/bigdata.html">bigdata</a></li>
            <li><a href="./category/git.html">git</a></li>
            <li><a href="./category/others.html">others</a></li>
   
        </ul>

        <h5 class="sidebar-title">Social</h5>
        <ul class="side-nav">
            <li><a href="https://github.com/xychu">GitHub</a></li>
            <li><a href="http://weibo.com/learn2live">Weibo</a></li>
        </ul>


        <h5 class="sidebar-title">Links</h5>
        <ul class="side-nav">
            <li><a href="http://book.douban.com/people/58301079/">豆瓣读书主页</a></li>
        </ul>

    </aside> <!-- End Sidebar -->

</div> <!-- End Main Content and Sidebar -->


<!-- Footer -->
<footer class="row">
    <div class="large-12 columns">
        <hr />
        <div class="row">
            <div class="large-6 columns">
              <!--                  <p>Edge Define: To Extend by xychu</p> -->
                  <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                      <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
                  </a>
            </div>
            </div>
    </div>
</footer>
<a href="http://github.com/xychu/xychu_pelican">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub" />
</a>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>